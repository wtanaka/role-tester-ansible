language: ruby
rvm:
  - 2.2
  - 2.1
  - 2.0
# Not supported by net-ssh >= 3, which in turn is required by
# kitchen-verifier-serverspec
#  - 1.9.3

sudo: required

services:
  - docker

before_install:
  - sudo apt-get update -qq
  - sudo apt-get install -y ansible

script:
  - ./_self_test.sh

after_failure:
  - (cd fake-role/role-tester; cat .kitchen/logs/*.log | grep -v '^I, ')
  - (cd fake-role-no-tests/role-tester; cat .kitchen/logs/*.log | grep -v '^I, ')

notifications:
  webhooks: https://galaxy.ansible.com/api/v1/notifications/
